# Stomp & SockJS 를 이용한 Push 알림

1. 일반적인 방법
- 로그인시 socket 통로 연결
- 이벤트가 발생해야 하는 비지니스 로직에서 SimpMessagingTemplate(메세지 브로커)를 주입 받은 후  라우팅 키와 보내고자 하는 메세지 전송
- 이때 라우팅 키는 보내고자 하는 회원의 ID에 해당하는 라우팅키로 전송
=> 단점 : 모든 비지니스 로직에서 메세지 브로커와 라우팅 키를 일일히 작성해야 함

2. event-driven 방식
- 푸쉬알림을 보내야하는 이벤트 발생시 로직에서 라우팅 키를 입력하지 않고 메세지만 입력하여 보내는 방식
- 상황 발생시 메세지 브로커를 이용하여 알림을 보내는 상황은 모두 같음 -> ApplicationContextEvent를 상속받아 메세지를 처리하는 로직 구현
- CustomEventListener에서 위에 작성한 이벤트를 EventListener에 등록
- 비지니스 로직에서 작성한 객체를 생성하여 메세지를 담아주어 해당 클래스에 대한 이벤트 발생시 푸쉬알림 발생
=> 여전히 비지니스 로직에서 중복 발생, 위에 방식에서와는 달리 라우팅 키를 미리 등록한 이벤트에서 처리

3. AOP 방식
- 어떠한 이벤트가 발생하였다는 것은 핵심 기능이지만, 기능이 발생하였다는 알림은 핵심 기능이 아님 => 관심사의 분리, 알림에 대한 기능을 따로 분리하여 처리
- 2번 방식 + advice(이벤트의 대상) 과 weaving(시점)을 정해주어 정해진 대상과 시점에서 이벤트 발생시 알림 전송
- 주의 사항 => map으로 특정 이벤트에 대한 메세지를 데이터화 시켜야 함(ex.회원가입-ooo님 회원가입을 축하드립니다)